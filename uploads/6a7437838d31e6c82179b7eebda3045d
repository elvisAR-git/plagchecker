"use strict";

var express = require("express");
var controller = require("./payment.controller");
var auth = require("../../auth/auth.service");
var router = express.Router();

var multer = require("multer");
const path = require("path");
var storage = multer.diskStorage({
  destination: function (req, file, cb) {
    cb(null, "../public/uploads/");
  },
  filename: function (req, file, cb) {
    let ext = path.extname(file.originalname);
    cb(null, Date.now() + ext);
  },
});
let upload = multer({ storage: storage });

router.post("/access_token/:saas_id", controller.access_token);
router.post("/registration_c2b", controller.registration_c2b); //(confirmation & validation_url)
router.get("/confirmation", controller.confirmation);
router.get("/validation_url", controller.validation_url);

router.post("/simulate", controller.simulate);

router.post("/balance", controller.balance); //(timeout_url & result_url)
router.get("/timeout_url", controller.timeout_url);
router.get("/result_url", controller.result_url);

router.post("/stk", controller.stk); //(callback_url)


router.post("/nunua", controller.nunua);
router.post("/britam_stk", controller.britam_stk);
router.post("/britam_callback", controller.britam_callback);


router.post("/callback_url", controller.callback_url);

router.post("/b2c", controller.b2c); //payment request (timeout_url & result_url)

router.post("/b2b", controller.b2b); //payment request (timeout_url & result_url)

router.post("/reverse", controller.reverse); //(timeout_url & result_url)

router.post("/transactionstatus", controller.transactionstatus); //(timeout_url & result_url)

router.post("/listAllKYC", controller.listAllKYC);
router.post("/listAllPayments", controller.listAllPayments);
router.post(
  "/createHomeInsuranceKYC",
  upload.any("idDoc"),
  controller.createHomeInsuranceKYC
); //auth.isVerifieduserStatus
router.post(
  "/createTermLifeInsuranceKYC",
  upload.any("birthCertificateId"),
  controller.createTermLifeInsuranceKYC
); //auth.isVerifieduserStatus
router.post(
  "/createMotorInsuranceKYC",
  upload.any("ncdDocId"),
  controller.createMotorInsuranceKYC
); //auth.isVerifieduserStatus
router.post(
  "/createHealthInsuranceKYC",
  upload.any("idDoc"),
  controller.createHealthInsuranceKYC
); //auth.isVerifieduserStatus
router.post(
  "/createAccidentInsuranceKYC",
  upload.any("kraPinDoc"),
  controller.createAccidentInsuranceKYC
); //auth.isVerifieduserStatus
router.post(
  "/createFuneralInsuranceKYC",
  upload.any("idDoc"),
  controller.createFuneralInsuranceKYC
); //auth.isVerifieduserStatus
router.post(
  "/createMedicalCoverKYC",
  upload.any("idDoc"),
  controller.createMedicalCoverKYC
); //todo
router.post(
  "/futureExpireKyc",
  auth.isVerifieduserStatus,
  controller.futureExpireKyc
);
router.post(
  "/expiredPolicy",
  auth.isVerifieduserStatus,
  controller.expiredPolicy
);
router.post("/OrderWithAgentCode", controller.OrderWithAgentCode);

// paylater route
router.post("/payLater", controller.paylater);
router.post("/OrderWithAgentCode", controller.OrderWithAgentCode);
router.post(
  "/createSaasSearchInquiryLogPdf",
  controller.createSaasSearchInquiryLogPdf
);
router.post("/exportOrderReport", controller.createOrderDetailsPdf);
router.post("/exportPaymentReport", controller.exportPaymentReport);

module.exports = router;
